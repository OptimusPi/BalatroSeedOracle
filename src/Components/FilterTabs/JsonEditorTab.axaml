<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:avalonedit="https://github.com/avaloniaui/avaloniaedit"
             xmlns:vm="using:BalatroSeedOracle.ViewModels.FilterTabs"
             x:Class="BalatroSeedOracle.Components.FilterTabs.JsonEditorTab"
             x:DataType="vm:JsonEditorTabViewModel">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>     <!-- Editor -->
            <RowDefinition Height="Auto"/>  <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- JSON Editor - Slick Design -->
        <Border Grid.Row="0"
                Background="#1e1e1e"
                BorderThickness="3"
                BorderBrush="{StaticResource ModalBorder}"
                CornerRadius="12"
                Padding="0"
                BoxShadow="inset 0 2 4 #00000040, 0 4 8 #00000020">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Editor Header Bar -->
                <Border Grid.Row="0"
                        Background="#2d2d30"
                        BorderBrush="#3e3e42"
                        BorderThickness="0,0,0,1"
                        CornerRadius="12,12,0,0"
                        Padding="12,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="ðŸ“„ filter.json" 
                                       Foreground="#cccccc" 
                                       FontFamily="{StaticResource BalatroFont}"
                                       FontSize="14"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="6">
                            <Button Content="âš¡" 
                                    ToolTip.Tip="Auto-format JSON"
                                    Command="{Binding FormatJsonCommand}"
                                    Width="28" Height="24"
                                    FontSize="14"
                                    Background="#404045"
                                    BorderThickness="0"
                                    CornerRadius="4"
                                    Foreground="#FFD700"/>
                            <Button Content="âœ“" 
                                    ToolTip.Tip="Validate JSON"
                                    Command="{Binding ValidateJsonCommand}"
                                    Width="28" Height="24"
                                    FontSize="14"
                                    Background="#404045"
                                    BorderThickness="0"
                                    CornerRadius="4"
                                    Foreground="#27ca3f"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Editor Content -->
                <avalonedit:TextEditor Grid.Row="1"
                                       Name="JsonEditor"
                                       SyntaxHighlighting="Json"
                                       ShowLineNumbers="True"
                                       FontFamily="{StaticResource BalatroFont}"
                                       FontSize="16"
                                       Background="#1e1e1e"
                                       Foreground="#ffffff"
                                       LineNumbersForeground="#888888"
                                       Margin="0"
                                       Padding="12,8"
                                       HorizontalScrollBarVisibility="Auto"
                                       VerticalScrollBarVisibility="Auto"/>
            </Grid>
        </Border>
        
        <!-- Status Bar (cleaned up - only essential buttons) -->
        <Border Grid.Row="1"
                Background="#252526"
                BorderBrush="#3e3e42"
                BorderThickness="0,1,0,0"
                Padding="12,6"
                Margin="0,8,0,0"
                CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Icon -->
                <Border Grid.Column="0"
                        Background="{Binding ValidationStatusColor, FallbackValue=#FFD700}"
                        Width="8" Height="8"
                        CornerRadius="4"
                        Margin="0,0,8,0"
                        VerticalAlignment="Center"/>

                <!-- Status Text -->
                <TextBlock Grid.Column="1"
                           Text="{Binding ValidationStatus, FallbackValue='Ready'}"
                           Foreground="#cccccc"
                           FontFamily="{StaticResource BalatroFont}"
                           FontSize="12"
                           VerticalAlignment="Center"/>

                <!-- Essential buttons only -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                    <Button Content="ðŸ’¾ Save"
                            ToolTip.Tip="Save current filter"
                            Background="#6f42c1"
                            Foreground="White"
                            BorderThickness="0"
                            CornerRadius="6"
                            Padding="10,6"
                            FontSize="11"
                            FontFamily="{StaticResource BalatroFont}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>