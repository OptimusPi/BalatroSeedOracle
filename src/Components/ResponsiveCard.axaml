<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:i="using:Avalonia.Xaml.Interactivity"
             xmlns:behaviors="using:BalatroSeedOracle.Behaviors"
             xmlns:local="clr-namespace:BalatroSeedOracle.Components"
             x:Class="BalatroSeedOracle.Components.ResponsiveCard">

    <UserControl.Styles>
        <!-- Card border styling - transparent background because card images are complete -->
        <Style Selector="Border#VisualBorder">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="BoxShadow" Value="0 2 8 0 #30000000, 0 0 0 1 #20000000"/>
        </Style>

        <!-- Subtle hover effect - slight lift with enhanced shadow -->
        <Style Selector="local|ResponsiveCard:pointerover Border#VisualBorder">
            <Setter Property="BoxShadow" Value="0 4 12 0 #40000000, 0 0 0 1 #20000000"/>
        </Style>

        <Style Selector="local|ResponsiveCard.selected-need Border#VisualBorder">
            <Setter Property="BoxShadow" Value="0 2 8 0 #30000000, 0 0 0 3 #4CAF50"/>
        </Style>

        <Style Selector="local|ResponsiveCard.selected-want Border#VisualBorder">
            <Setter Property="BoxShadow" Value="0 2 8 0 #30000000, 0 0 0 3 #EF5350"/>
        </Style>

        <Style Selector="local|ResponsiveCard.selected-need:pointerover Border#VisualBorder">
            <Setter Property="BoxShadow" Value="0 4 12 0 #40000000, 0 0 0 3 #66BB6A"/>
        </Style>

        <Style Selector="local|ResponsiveCard.selected-want:pointerover Border#VisualBorder">
            <Setter Property="BoxShadow" Value="0 4 12 0 #40000000, 0 0 0 3 #FF6659"/>
        </Style>

        <!-- Soul image styles for legendary jokers -->
        <Style Selector="Image#SoulImage">
            <Setter Property="Opacity" Value="0.8"/>
        </Style>
    </UserControl.Styles>

    <!-- The card IS the border - no extra wrapper needed! -->
    <!-- CardBorder: Outer container for hit testing (hitbox stays fixed) -->
    <Border Name="CardBorder"
            Cursor="Hand"
            IsHitTestVisible="True"
            Margin="2">
        <!-- VisualBorder: Inner border for visual transforms (uses RenderTransform so hitbox is NOT affected) -->
        <Border Name="VisualBorder"
                IsHitTestVisible="False"
                RenderTransformOrigin="0.5,0.5">
            <Border.RenderTransform>
                <TransformGroup>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                    <TranslateTransform X="0" Y="0"/>
                </TransformGroup>
            </Border.RenderTransform>
            <i:Interaction.Behaviors>
                <!-- Simplified hover effect: scale pulse only (no translation jiggle) -->
                <behaviors:MagneticTiltBehavior ScalePulseAmount="0.05" />
            </i:Interaction.Behaviors>
            <Border.Transitions>
                <Transitions>
                    <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.15"/>
                </Transitions>
            </Border.Transitions>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Card image container -->
                    <Grid Grid.Row="0" Name="ImageContainer">
                        <!-- Gold background for legendary jokers -->
                        <Border Name="LegendaryBackground"
                                IsVisible="False"
                                CornerRadius="4"
                                Margin="2">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Color="{Binding Source={StaticResource GoldGradient1}, Path=Color}" Offset="0" />
                                    <GradientStop Color="{Binding Source={StaticResource GoldGradient2}, Path=Color}" Offset="0.5" />
                                    <GradientStop Color="{Binding Source={StaticResource GoldGradient1}, Path=Color}" Offset="1" />
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>

                        <!-- Base card image -->
                        <Image Name="CardImage"
                               Stretch="Uniform"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Margin="2" />

                        <!-- Soul/Face overlay for legendary jokers -->
                        <Image Name="SoulImage"
                               IsVisible="False"
                               Width="64"
                               Height="64"
                               Stretch="Uniform"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               RenderTransformOrigin="0.5,0.5">
                            <Image.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    <TranslateTransform X="0" Y="0"/>
                                </TransformGroup>
                            </Image.RenderTransform>
                        </Image>

                        <!-- Edition overlay for jokers with editions -->
                        <Image Name="EditionOverlay"
                               IsVisible="False"
                               Width="64"
                               Height="64"
                               Stretch="Uniform"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                    </Grid>

        <!-- Card name below image - allow text to extend naturally -->
        <TextBlock Grid.Row="1"
                   Name="CardName"
                   TextAlignment="Center"
                   TextWrapping="Wrap"
                   Foreground="#2A2A2A"
                   FontFamily="{StaticResource BalatroFont}"
                   FontSize="10"
                   LineHeight="11"
                   Margin="2,2,2,4" />
        </Grid>
        </Border> <!-- End VisualBorder -->
    </Border> <!-- End CardBorder -->

</UserControl>