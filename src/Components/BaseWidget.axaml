<ContentControl xmlns="https://github.com/avaloniaui"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:vm="using:BalatroSeedOracle.ViewModels"
                x:Class="BalatroSeedOracle.Components.BaseWidget"
                x:DataType="vm:BaseWidgetViewModel">

    <!-- SHARED BASE WIDGET COMPONENT - All widgets use this! -->
    <Grid>
        <!-- Minimized State -->
        <Grid Name="MinimizedView"
              IsVisible="{Binding IsMinimized}">
            <Button Classes="widget-icon"
                    Width="100" Height="100"
                    Background="{StaticResource Red}"
                    BorderBrush="{StaticResource ModalBorder}"
                    BorderThickness="3"
                    CornerRadius="12"
                    Cursor="Hand"
                    Command="{Binding ExpandCommand}">
                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding WidgetIcon}" FontSize="19" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding WidgetTitle}" FontSize="12" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </Grid>

        <!-- Expanded State -->
        <Border Name="ExpandedView"
                Classes="widget-container"
                Background="{StaticResource MediumBackground}"
                IsVisible="{Binding !IsMinimized}"
                Width="350" Height="450">

            <Grid RowDefinitions="Auto,*">
                <!-- Header with Title and Window Controls -->
                <Border Grid.Row="0" Classes="widget-header" Padding="12,8"
                        PointerPressed="OnHeaderPointerPressed"
                        PointerMoved="OnHeaderPointerMoved"
                        PointerReleased="OnHeaderPointerReleased"
                        PointerCaptureLost="OnHeaderPointerCaptureLost"
                        Cursor="Hand">
                    <Grid ColumnDefinitions="*,Auto,Auto,Auto">
                        <!-- Title -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="{Binding WidgetIcon}" FontSize="15" VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding WidgetTitle}"
                                       FontSize="13"
                                       FontWeight="Bold"
                                       Foreground="White"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Window Control Buttons -->
                        <Button Grid.Column="1"
                                Content="_"
                                Classes="widget-minimize-btn"
                                Command="{Binding MinimizeCommand}"
                                ToolTip.Tip="Minimize"/>

                        <Button Grid.Column="2"
                                Content="□"
                                Classes="widget-minimize-btn"
                                Command="{Binding MaximizeCommand}"
                                ToolTip.Tip="Maximize"
                                IsVisible="False"/>

                        <Button Grid.Column="3"
                                Content="✕"
                                Classes="widget-minimize-btn"
                                Command="{Binding CloseCommand}"
                                ToolTip.Tip="Close"/>
                    </Grid>
                </Border>

                <!-- Content Area (scrollable) -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="15">
                    <Border Classes="widget-content light" Padding="15">
                        <ContentPresenter Name="PART_ContentPresenter"/>
                    </Border>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>

</ContentControl>
