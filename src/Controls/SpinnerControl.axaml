<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="using:BalatroSeedOracle.Converters"
             x:Class="BalatroSeedOracle.Controls.SpinnerControl">
    
    <UserControl.Resources>
        <converters:ShadowDirectionToMarginConverter x:Key="ShadowMarginConverter"/>
        <converters:ShadowDirectionToPressedMarginConverter x:Key="ShadowPressedMarginConverter"/>
    </UserControl.Resources>
    
    <UserControl.Styles>
        <!-- Arrow button style -->
        <Style Selector="Button.arrow-button">
            <Setter Property="Width" Value="28"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="{StaticResource Red}"/>
            <Setter Property="Foreground" Value="{StaticResource White}"/>
            <Setter Property="FontFamily" Value="{StaticResource BalatroFont}"/>
            <Setter Property="FontSize" Value="16"/>
            
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="0,1,0,4"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Grid>
                        <!-- Drop shadow -->
                        <Border Name="PART_Shadow"
                                Background="{StaticResource HoverShadow}"
                                CornerRadius="4"
                                Margin="{Binding ShadowDirection, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource ShadowMarginConverter}, ConverterParameter=button}"/>
                        <!-- Button -->
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Margin="0,0,0,4">
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter>
        </Style>
        
        <Style Selector="Button.arrow-button:pointerover">
            <Setter Property="Background" Value="{StaticResource RedHover}"/>
        </Style>

        <Style Selector="Button.arrow-button:pressed">
            <Setter Property="Background" Value="{StaticResource RedHover}"/>
        </Style>

        <!-- Hide shadow when pressed for pressed effect -->
        <Style Selector="Button.arrow-button:pressed /template/ Border#PART_Shadow">
            <Setter Property="IsVisible" Value="False"/>
        </Style>
        
        <!-- Value display badge style -->
        <Style Selector="Button.value-badge">
            <Setter Property="Background" Value="{StaticResource Red}"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="MinWidth" Value="60"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Arrow"/>
            <Setter Property="IsHitTestVisible" Value="False"/>
        </Style>

        <!-- Removed hover style - value badge is not clickable -->

        
        <!-- Value badge drop shadow -->
        <Style Selector="Grid.value-badge-container">
            <Setter Property="Height" Value="36"/>
        </Style>
        
        <!-- Label style -->
        <Style Selector="TextBlock.spinner-label">
            <Setter Property="FontFamily" Value="{StaticResource BalatroFont}"/>
            <Setter Property="FontSize" Value="12"/>
            
            <Setter Property="Foreground" Value="{StaticResource VeryLightGrey}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        
        <!-- Value text style -->
        <Style Selector="TextBlock.value-text">
            <Setter Property="FontFamily" Value="{StaticResource BalatroFont}"/>
            <Setter Property="FontSize" Value="14"/>
            
            <Setter Property="Foreground" Value="{StaticResource White}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- Dots indicator -->
        <Style Selector="TextBlock.dots-indicator">
            <Setter Property="FontFamily" Value="{StaticResource BalatroFont}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{StaticResource White}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="Margin" Value="0,0,0,2"/>
        </Style>
    </UserControl.Styles>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Label -->
        <TextBlock Grid.Row="0"
                   Name="LabelText"
                   Classes="spinner-label"
                   Text="{Binding Label, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
        
        <!-- Spinner control -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left arrow -->
            <Button Grid.Column="0"
                    Name="DecrementButton"
                    Classes="arrow-button"
                    Content="&lt;"
                    Click="OnDecrementClick"/>
            
            <!-- Value badge with drop shadow -->
            <Grid Grid.Column="2" Classes="value-badge-container">
                <!-- Drop shadow -->
                <Border Background="{StaticResource HoverShadow}"
                        CornerRadius="6"
                        HorizontalAlignment="Stretch"
                        Height="32"
                        Margin="{Binding ShadowDirection, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource ShadowMarginConverter}, ConverterParameter=badge}"/>
                <!-- Badge -->
                <Button Name="ValueButton"
                        Classes="value-badge"
                        HorizontalAlignment="Stretch"
                        Click="OnValueButtonClick">
                    <Grid>
                        <!-- Display mode -->
                        <TextBlock Name="ValueText"
                                   Classes="value-text"
                                   IsVisible="{Binding !IsEditing, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
                        <!-- Edit mode -->
                        <TextBox Name="ValueEdit"
                                 Classes="value-text"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Padding="0"
                                 TextAlignment="Center"
                                 IsVisible="{Binding IsEditing, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                 LostFocus="OnValueEditLostFocus"
                                 KeyDown="OnValueEditKeyDown"/>
                    </Grid>
                </Button>
            </Grid>
            
            <!-- Right arrow -->
            <Button Grid.Column="4"
                    Name="IncrementButton"
                    Classes="arrow-button"
                    Content="&gt;"
                    Click="OnIncrementClick"/>
        </Grid>
    </Grid>
</UserControl>