<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="BalatroSeedOracle.Controls.SortableResultsGrid">
    
    <UserControl.Resources>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header with sorting controls -->
        <Border Grid.Row="0" 
                Background="{StaticResource ContainerDarkPrecise}" 
                BorderBrush="{StaticResource ModalBorder}" 
                BorderThickness="0,0,0,2" 
                Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="15">
                    <TextBlock Text="ðŸ” SEARCH RESULTS" 
                               Foreground="{StaticResource TextLight}" 
                               FontFamily="{StaticResource BalatroFont}" 
                               FontSize="18" 
                               FontWeight="Bold"
                               VerticalAlignment="Center"/>
                    
                    <TextBlock Name="ResultsCountText" 
                               Text="0 results" 
                               Foreground="{StaticResource Gold}" 
                               FontSize="14"
                               VerticalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                    <!-- Sort controls -->
                    <TextBlock Text="Sort by:" 
                               Foreground="{StaticResource TextLight}" 
                               FontSize="12" 
                               VerticalAlignment="Center"/>
                    
                    <ComboBox Name="SortComboBox" 
                              Background="{StaticResource ContainerDarkPrecise}"
                              Foreground="{StaticResource Gold}"
                              BorderBrush="{StaticResource ModalBorder}"
                              SelectionChanged="SortComboBox_SelectionChanged"
                              MinWidth="160">
                        <ComboBoxItem Content="Seed" Tag="Seed"/>
                        <ComboBoxItem Content="Score â†“" Tag="TotalScore_Desc" IsSelected="True"/>
                        <ComboBoxItem Content="Score â†‘" Tag="TotalScore_Asc"/>
                        <ComboBoxItem Content="Date Found â†“" Tag="DateFound_Desc"/>
                        <ComboBoxItem Content="Date Found â†‘" Tag="DateFound_Asc"/>
                    </ComboBox>
                    
                    <!-- Export button -->
                    <Button Content="ðŸ“¤ Export" 
                            Name="ExportButton"
                            Click="ExportButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main DataGrid -->
        <DataGrid Grid.Row="1" 
                  Name="ResultsDataGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  DoubleTapped="ResultsDataGrid_DoubleTapped">
            <DataGrid.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="ðŸ“‹ Copy seed"
                              Command="{Binding $parent[UserControl].CopySeedCommand}"
                              CommandParameter="{Binding #ResultsDataGrid.SelectedItem.Seed}"/>
                    <MenuItem Header="ðŸ” Search similar"
                              Command="{Binding $parent[UserControl].SearchSimilarCommand}"
                              CommandParameter="{Binding #ResultsDataGrid.SelectedItem}"/>
                    <MenuItem Header="â­ Add to favorites"
                              Command="{Binding $parent[UserControl].AddToFavoritesCommand}"
                              CommandParameter="{Binding #ResultsDataGrid.SelectedItem}"/>
                    <MenuItem Header="ðŸ“¤ Export this seed"
                              Command="{Binding $parent[UserControl].ExportSeedCommand}"
                              CommandParameter="{Binding #ResultsDataGrid.SelectedItem}"/>
                </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
                <!-- Seed column with copy button -->
                <DataGridTemplateColumn Header="ðŸŽ² Seed" Width="150" SortMemberPath="Seed">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="5">
                                <TextBlock Text="{Binding Seed}" 
                                           FontFamily="Consolas" 
                                           FontSize="12" 
                                           VerticalAlignment="Center"/>
                                <Button Classes="copy-btn"
                                        Content="ðŸ“‹"
                                        ToolTip.Tip="Copy seed to clipboard"
                                        Command="{Binding $parent[UserControl].CopySeedCommand}"
                                        CommandParameter="{Binding Seed}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                
                <!-- Score column -->
                <DataGridTextColumn Header="ðŸ† Score" 
                                    Binding="{Binding TotalScore}" 
                                    Width="80"
                                    SortMemberPath="TotalScore"/>
                
                <!-- Individual Scores column -->
                <DataGridTemplateColumn Header="ðŸ“Š Scores" Width="200">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding ScoresDisplay}" 
                                       FontFamily="Consolas" 
                                       FontSize="11"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                
                <!-- Date Found column -->
                <DataGridTextColumn Header="â° Found" 
                                    Binding="{Binding DateFound, StringFormat='{}{0:HH:mm:ss}'}" 
                                    Width="80"
                                    SortMemberPath="DateFound"/>
                
                <!-- Actions column -->
                <DataGridTemplateColumn Header="âš¡ Actions" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="3">
                                <Button Classes="copy-btn"
                                        Content="ðŸ”"
                                        ToolTip.Tip="Search similar"
                                        Command="{Binding $parent[UserControl].SearchSimilarCommand}"
                                        CommandParameter="{Binding}"/>
                                <Button Classes="copy-btn"
                                        Content="â­"
                                        ToolTip.Tip="Add to favorites"
                                        Command="{Binding $parent[UserControl].AddToFavoritesCommand}"
                                        CommandParameter="{Binding}"/>
                                <Button Classes="copy-btn"
                                        Content="ðŸ“¤"
                                        ToolTip.Tip="Export this seed"
                                        Command="{Binding $parent[UserControl].ExportSeedCommand}"
                                        CommandParameter="{Binding}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- Footer with pagination and stats -->
        <Border Grid.Row="2" 
                Background="{StaticResource ContainerDarkPrecise}" 
                BorderBrush="{StaticResource ModalBorder}" 
                BorderThickness="0,2,0,0" 
                Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Stats -->
                <TextBlock Grid.Column="0" 
                           Name="StatsText"
                           Text="Ready to search"
                           Foreground="{StaticResource TextLight}" 
                           FontSize="12"
                           VerticalAlignment="Center"/>
                
                <!-- Pagination -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="8">
                    <Button Name="PreviousButton"
                            Content="â—€"
                            Classes="btn-red"
                            Width="40"
                            Height="32"
                            Padding="0"
                            VerticalAlignment="Center"
                            IsEnabled="False"
                            Click="PreviousButton_Click"/>

                    <Button Name="PageInfoBadge"
                            Content="Page 1 of 1"
                            Classes="btn-red"
                            MinWidth="100"
                            Height="32"
                            IsHitTestVisible="False"
                            VerticalAlignment="Center"/>

                    <Button Name="NextButton"
                            Content="â–¶"
                            Classes="btn-red"
                            Width="40"
                            Height="32"
                            Padding="0"
                            VerticalAlignment="Center"
                            IsEnabled="False"
                            Click="NextButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
