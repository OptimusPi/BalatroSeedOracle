<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BalatroSeedOracle.ViewModels.Controls"
             xmlns:material="clr-namespace:IconPacks.Avalonia.Material;assembly=IconPacks.Avalonia.Material"
             xmlns:treeDataGrid="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.TreeDataGrid"
             x:Class="BalatroSeedOracle.Controls.SortableResultsGrid"
             x:DataType="vm:SortableResultsGridViewModel">

    <Grid RowDefinitions="Auto,*">
        <!-- Stats and Actions Header -->
        <Border Grid.Row="0" 
                Background="{StaticResource DarkBackground}" 
                Padding="12,8"
                BorderBrush="{StaticResource ModalBorder}"
                BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="*,Auto">
                <!-- Stats Text -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="15" VerticalAlignment="Center">
                    <TextBlock Text="{Binding ResultsCountText}" 
                               FontFamily="{StaticResource BalatroFont}"
                               FontSize="16"
                               Foreground="{StaticResource Gold}"/>
                    <TextBlock Text="{Binding StatsText}" 
                               FontSize="12"
                               Foreground="{StaticResource LightGrey}"
                               VerticalAlignment="Center"
                               Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding SelectedCountText}" 
                               FontSize="12"
                               Foreground="{StaticResource BrightGreenEditor}"
                               VerticalAlignment="Center"
                               Margin="8,2,0,0"
                               IsVisible="{Binding HasSelection}"/>
                </StackPanel>

                <!-- Actions -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Command="{Binding CopySelectedCommand}" 
                            ToolTip.Tip="Copy selected seeds (Ctrl+C)"
                            Classes="btn-blue"
                            Padding="8,4"
                            IsEnabled="{Binding HasSelection}">
                        <material:PackIconMaterial Kind="ContentCopy" Width="14" Height="14"/>
                    </Button>
                    <Button Command="{Binding PopOutCommand}" 
                            ToolTip.Tip="Open in new window"
                            Classes="btn-blue"
                            Padding="8,4">
                        <material:PackIconMaterial Kind="OpenInNew" Width="14" Height="14"/>
                    </Button>
                    <Button Command="{Binding ExportAllCommand}" 
                            ToolTip.Tip="Export all results"
                            Classes="btn-green"
                            Padding="8,4">
                        <material:PackIconMaterial Kind="FileExport" Width="14" Height="14"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- TreeDataGrid - MVVM binding to Source -->
        <treeDataGrid:TreeDataGrid Grid.Row="1"
                                   x:Name="ResultsTreeDataGrid"
                                   Source="{Binding GridSource}"
                                   CanUserSortColumns="True"
                                   CanUserResizeColumns="True"
                                   Background="{StaticResource DarkBackground}"
                                   Foreground="White"/>
    </Grid>
</UserControl>
