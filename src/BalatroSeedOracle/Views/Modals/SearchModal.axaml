<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BalatroSeedOracle.ViewModels"
             xmlns:controls="using:BalatroSeedOracle.Controls"
             x:Class="BalatroSeedOracle.Views.Modals.SearchModal"
             x:DataType="vm:SearchModalViewModel">

    <!-- Layout: header tabs on top, content area below -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header area with tabs and minimize button -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Balatro-style tab control with automatic triangle positioning -->
            <controls:BalatroTabControl Grid.Column="0"
                                        HorizontalAlignment="Center"
                                        Margin="0,0,0,0"
                                        SelectedIndex="{Binding SelectedTabIndex}">
                <controls:BalatroTabControl.Items>
                    <TabItem Header="Search"/>
                    <TabItem Header="Results"/>
                </controls:BalatroTabControl.Items>
            </controls:BalatroTabControl>

            <!-- Minimize & Continue button (only visible when search is active) -->
            <Button Grid.Column="1"
                    Content="Minimize &amp; Continue"
                    Command="{Binding MinimizeToDesktopCommand}"
                    IsVisible="{Binding CanMinimizeToDesktopVisible}"
                    Background="{StaticResource Orange}"
                    Foreground="White"
                    FontFamily="{StaticResource BalatroFont}"
                    FontSize="14"
                    FontWeight="Bold"
                    Padding="12,6"
                    Margin="8,0,8,0"
                    VerticalAlignment="Center"
                    CornerRadius="6"
                    BorderThickness="2"
                    BorderBrush="{StaticResource ModalBorder}"/>
        </Grid>

        <!-- Content area: let inner tabs provide their own dark panels -->
        <Border Grid.Row="1"
                Background="Transparent"
                BorderThickness="0"
                CornerRadius="0,0,12,12"
                Padding="0"
                Margin="0,4,0,0"
                ClipToBounds="False">
            <!-- Show the selected tabâ€™s content directly.
                 Removing the outer ScrollViewer prevents the Results DataGrid
                 from measuring to infinite height and pushing the footer far below. -->
            <ContentPresenter Content="{Binding CurrentTabContent}"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"/>
        </Border>
    </Grid>
</UserControl>
